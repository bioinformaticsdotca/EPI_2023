<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 5: Downstream Analysis and Online Tools | Epigenomic Analysis 2023</title>
  <meta name="description" content="Workshop website for the {{YEAR}} {{WORKSHOP_NAME}} Canadian Bioinformatics Workshop" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 5: Downstream Analysis and Online Tools | Epigenomic Analysis 2023" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bioinformaticsdotca.github.io/EPI_2023/img/bioinformatics_logo.png" />
  <meta property="og:description" content="Workshop website for the {{YEAR}} {{WORKSHOP_NAME}} Canadian Bioinformatics Workshop" />
  <meta name="github-repo" content="bioinformaticsdotca/EPI_2023" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 5: Downstream Analysis and Online Tools | Epigenomic Analysis 2023" />
  
  <meta name="twitter:description" content="Workshop website for the {{YEAR}} {{WORKSHOP_NAME}} Canadian Bioinformatics Workshop" />
  <meta name="twitter:image" content="https://bioinformaticsdotca.github.io/EPI_2023/img/bioinformatics_logo.png" />

<meta name="author" content="Faculty: Guillaume Bourque, Martin Hirst, David Bujold, Jose Hector Galvez, Edmund Su, Mareike Janiak, Michelle Brazas, Nia Hughes, and Zhibin Lu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "name": "{{WORKSHOP_NAME}}",
  "description": "The complete set of tutorials, slides, and practical exercises for the {{WORKSHOP_NAME}} {{YEAR}} Canadian Bioinformatics Workshop, hosted on GitHub Pages.",
  "url": "https://bioinformaticsdotca.github.io/{{WORKSHOP_CODE}}",
  "learningResourceType": ["tutorial", "slides", "exercise"],
  "inLanguage": "en",
  "license": "https://creativecommons.org/licenses/by/4.0/",
  "provider": {
    "@type": "Organization",
    "name": "Bioinformatics.ca",
    "url": "https://bioinformatics.ca"
  },
  "keywords": "",
  "isPartOf": {
    "@type": "Course",
    "@id": "{{URL}}"
  }
}
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://bioinformaticsdotca.github.io/">
 <img src="img/bioinformatics_logo.png" width="90%" alt="bioinformatics.ca logo" style="display:block; margin-left:auto; margin-right:auto; margin-top:15px;">
 </a>
<li><center><strong><a href="./"><br>Epigenomic Analysis<br><br></a></strong></center></li>
<a href="./">
 <img src="img/CBW_Epigenome-data_icon.png" width="70%" alt="Epigenomic Analysis logo" style="display:block; margin-left:auto; margin-right:auto; ">
 </a>
<br>

<li class="divider"></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Workshop Info</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-work"><i class="fa fa-check"></i>Pre-work</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#class-photo"><i class="fa fa-check"></i>Class Photo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="meet-your-faculty.html"><a href="meet-your-faculty.html"><i class="fa fa-check"></i>Meet Your Faculty</a></li>
<li class="chapter" data-level="" data-path="data-and-compute-setup.html"><a href="data-and-compute-setup.html"><i class="fa fa-check"></i>Data and Compute Setup</a></li>
<li class="part"><span><b>II Modules</b></span></li>
<li class="chapter" data-level="" data-path="module-1-introduction-to-chip-sequencing-and-analysis.html"><a href="module-1-introduction-to-chip-sequencing-and-analysis.html"><i class="fa fa-check"></i>Module 1: Introduction to ChIP Sequencing and Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="module-1-introduction-to-chip-sequencing-and-analysis.html"><a href="module-1-introduction-to-chip-sequencing-and-analysis.html#lecture"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-1-introduction-to-chip-sequencing-and-analysis.html"><a href="module-1-introduction-to-chip-sequencing-and-analysis.html#lab"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-1-introduction-to-chip-sequencing-and-analysis.html"><a href="module-1-introduction-to-chip-sequencing-and-analysis.html#breakdown-of-markdown-file"><i class="fa fa-check"></i>Breakdown of Markdown File</a></li>
<li class="chapter" data-level="" data-path="module-1-introduction-to-chip-sequencing-and-analysis.html"><a href="module-1-introduction-to-chip-sequencing-and-analysis.html#module-1.-alignment"><i class="fa fa-check"></i>Module 1. Alignment</a></li>
<li class="chapter" data-level="" data-path="module-1-introduction-to-chip-sequencing-and-analysis.html"><a href="module-1-introduction-to-chip-sequencing-and-analysis.html#server-resources"><i class="fa fa-check"></i>Server resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-2-alignment-peak-calling-and-visualization.html"><a href="module-2-alignment-peak-calling-and-visualization.html"><i class="fa fa-check"></i>Module 2: Alignment, Peak Calling, and Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="module-2-alignment-peak-calling-and-visualization.html"><a href="module-2-alignment-peak-calling-and-visualization.html#lecture-1"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-2-alignment-peak-calling-and-visualization.html"><a href="module-2-alignment-peak-calling-and-visualization.html#lab-1"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-2-alignment-peak-calling-and-visualization.html"><a href="module-2-alignment-peak-calling-and-visualization.html#breakdown-of-markdown-file-1"><i class="fa fa-check"></i>Breakdown of Markdown File</a></li>
<li class="chapter" data-level="" data-path="module-2-alignment-peak-calling-and-visualization.html"><a href="module-2-alignment-peak-calling-and-visualization.html#module-2.-peak-calling"><i class="fa fa-check"></i>Module 2. Peak Calling</a></li>
<li class="chapter" data-level="" data-path="module-2-alignment-peak-calling-and-visualization.html"><a href="module-2-alignment-peak-calling-and-visualization.html#server-resources-1"><i class="fa fa-check"></i>Server resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-3-chip-seq-differential-analysis.html"><a href="module-3-chip-seq-differential-analysis.html"><i class="fa fa-check"></i>Module 3: ChIP-seq Differential Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="module-3-chip-seq-differential-analysis.html"><a href="module-3-chip-seq-differential-analysis.html#lecture-2"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-3-chip-seq-differential-analysis.html"><a href="module-3-chip-seq-differential-analysis.html#lab-2"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-3-chip-seq-differential-analysis.html"><a href="module-3-chip-seq-differential-analysis.html#breakdown-of-markdown-file-2"><i class="fa fa-check"></i>Breakdown of markdown file</a></li>
<li class="chapter" data-level="" data-path="module-3-chip-seq-differential-analysis.html"><a href="module-3-chip-seq-differential-analysis.html#module-3---differential-analysis"><i class="fa fa-check"></i>Module 3 - Differential Analysis</a></li>
<li class="chapter" data-level="" data-path="module-3-chip-seq-differential-analysis.html"><a href="module-3-chip-seq-differential-analysis.html#server-resources-2"><i class="fa fa-check"></i>Server resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><i class="fa fa-check"></i>Module 4: Whole-Genome Bisulfite Sequencing and Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html#lecture-3"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html#lab-3"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html#introduction"><i class="fa fa-check"></i>1. Introduction</a></li>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html#mapping-tutorial"><i class="fa fa-check"></i>2. Mapping Tutorial</a></li>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html#differential-methylation-analysis-in-methylkit"><i class="fa fa-check"></i>3. Differential Methylation Analysis in MethylKit</a></li>
<li class="chapter" data-level="" data-path="module-4-whole-genome-bisulfite-sequencing-and-analysis.html"><a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html#differential-methylation-analysis-in-dss"><i class="fa fa-check"></i>4. Differential Methylation Analysis in DSS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html"><i class="fa fa-check"></i>Module 5: Downstream Analysis and Online Tools</a>
<ul>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#lecture-4"><i class="fa fa-check"></i>Lecture</a></li>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#lab-4"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#ihec-data-portal"><i class="fa fa-check"></i>IHEC Data Portal</a></li>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#predicting-motifs-with-homer"><i class="fa fa-check"></i>Predicting Motifs with HOMER</a></li>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#looking-for-go-terms-enrichment-with-great"><i class="fa fa-check"></i>Looking for GO Terms Enrichment with GREAT</a></li>
<li class="chapter" data-level="" data-path="module-5-downstream-analysis-and-online-tools.html"><a href="module-5-downstream-analysis-and-online-tools.html#going-back-to-homer-results"><i class="fa fa-check"></i>Going back to HOMER Results</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<h1 id="sponsors">Sponsors</h1>
<center>
<<a href="https://genomecanada.ca/"><img src="img/sponsors/genomecanada.png" height="70" style="display:inline-block;"  style="padding-bottom: 20px" alt="Genome Canada logo.">
<a href="https://www.ontariogenomics.ca/"><img src="img/sponsors/ontariogenomics.png" height="70" style="display:inline-block;" style="padding-bottom: 20px;" alt="Ontario Genomics logo.">
<br><br>
<a href="https://oicr.on.ca/"><img src="img/sponsors/oicr.png" width=25% style="display:inline-block;" style="padding-bottom: 20px" alt="Ontario Institute for Cancer Research logo.">
<a href="https://www.hpcforhealth.ca/"><img src="img/sponsors/hpc4health.png" width=60% style="display:inline-block;" style="padding-bottom: 20px "alt="HPC4Health logo.">
<br><br>
<a href="https://computationalgenomics.ca/"><img src="img/sponsors/c3g_Web.png" style="display:inline-block;" width=35% style="padding-bottom: 20px" alt="Canadian Centre for Computational Genomcis logo.">

<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epigenomic Analysis 2023</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="module-5-downstream-analysis-and-online-tools" class="section level1 hasAnchor">
<h1>Module 5: Downstream Analysis and Online Tools<a href="module-5-downstream-analysis-and-online-tools.html#module-5-downstream-analysis-and-online-tools" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lecture-4" class="section level2 hasAnchor">
<h2>Lecture<a href="module-5-downstream-analysis-and-online-tools.html#lecture-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe width="640" height="360" src="https://www.youtube.com/embed/NMrG-ldA2xs?si=2M1apwYdlhBLLARE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
<p><br></p>
<iframe src="https://drive.google.com/file/d/1fkyHvtBh0IcCuMLBaVVo3WOjxC6UegHJ/preview" width="640" height="480" allow="autoplay">
</iframe>
</div>
<div id="lab-4" class="section level2 hasAnchor">
<h2>Lab<a href="module-5-downstream-analysis-and-online-tools.html#lab-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-1" class="section level3 hasAnchor">
<h3>Introduction<a href="module-5-downstream-analysis-and-online-tools.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="description-of-the-lab-1" class="section level4 hasAnchor">
<h4>Description of the Lab<a href="module-5-downstream-analysis-and-online-tools.html#description-of-the-lab-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We will now explore some of the tools that were covered in the lecture for module 5.</p>
<p>In this lab, we will:</p>
<ul>
<li>Learn how to use an online resource, the IHEC Data Portal, to fetch feature tracks of interest.</li>
<li>Explore ChIP-Seq peak prediction files (in bed format) to discover motifs using HOMER.</li>
<li>Use an IHEC dataset with the GREAT GO enrichment tool to perform functions prediction.</li>
</ul>
</div>
<div id="local-software-that-will-be-needed" class="section level4 hasAnchor">
<h4>Local Software That will be Needed<a href="module-5-downstream-analysis-and-online-tools.html#local-software-that-will-be-needed" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Tool to connect to your remote terminal session (e.g. Putty in Windows)</li>
<li>A web browser</li>
<li>The IGV genome browser</li>
</ul>
</div>
<div id="prepare-directory-for-module-5" class="section level4 hasAnchor">
<h4>Prepare Directory for Module 5<a href="module-5-downstream-analysis-and-online-tools.html#prepare-directory-for-module-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>From your command line terminal, go to your workspace folder.</p>
<pre><code>cd ~/workspace</code></pre>
<ul>
<li>If it exists, remove any <code>module5</code> directory in your home directory with the “rm” command</li>
<li>Create a new <code>module5</code> directory</li>
<li>Go to that directory</li>
</ul>
<pre><code>rm -rf module5
mkdir module5
cd module5</code></pre>
</div>
</div>
<div id="ihec-data-portal" class="section level3 hasAnchor">
<h3>IHEC Data Portal<a href="module-5-downstream-analysis-and-online-tools.html#ihec-data-portal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="exploring-available-datasets" class="section level4 hasAnchor">
<h4>Exploring Available Datasets<a href="module-5-downstream-analysis-and-online-tools.html#exploring-available-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Open a web browser on your computer, and load the URL <a href="http://epigenomesportal.ca/ihec" class="uri">http://epigenomesportal.ca/ihec</a></li>
<li>In the Overview page, click on the “View all” button, below the pie charts</li>
<li>You will get a grid with all available datasets for IHEC Core Assays, on the hg38 assembly
<ul>
<li>You can filter out visible datasets in the grid using the filtering options at the right of the grid</li>
</ul></li>
<li>Go back to the Overview page (<code>Home</code> on the top menu), and select the following categories of datasets: On the “hg38” reference genome, “Histone” experiments for the “Blood” cell type. Click on <code>View selected</code></li>
</ul>
<p><img src="img/portal_select_from_overview.png" /></p>
<ul>
<li>Only these categories will now get displayed in the grid. Expand the “Blood” category by clicking on the black triangle, and select the following grid cell:</li>
</ul>
<p><img src="img/portal_blood_h3k27ac.png" /></p>
</div>
<div id="visualizing-the-tracks" class="section level4 hasAnchor">
<h4>Visualizing the Tracks<a href="module-5-downstream-analysis-and-online-tools.html#visualizing-the-tracks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Click on the “Send” button for the UCSC Genome Browser, at the bottom of the grid</li>
</ul>
<p><img src="img/portal_send_to_ucsc.png" /></p>
<ul>
<li>You can see that the datasets are being displayed on the UCSC Genome Browser. These are all peaks and signal for the chosen blood H3K27ac ChIP-Seq datasets. In the Genome Browser, you can expand the tracks by changing visibility from “pack” to “full” and clicking the “Refresh” button</li>
</ul>
<p><img src="img/ucsc_fullTrackView.png" /></p>
<ul>
<li>You can also download these tracks locally for visualization in IGV
<ul>
<li>Go back to the IHEC Data Portal tab</li>
<li>Click on the “Download tracks” button at the bottom of the grid</li>
<li>Use the download links to download a few of the available tracks</li>
<li>Open them in IGV</li>
</ul></li>
</ul>
</div>
<div id="tracks-correlation" class="section level4 hasAnchor">
<h4>Tracks Correlation<a href="module-5-downstream-analysis-and-online-tools.html#tracks-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can get a whole genome overview of the similarity of a group of tracks by using the Portal’s correlation tool.</p>
<ul>
<li>Back on the Data Grid tab of your browser, from the filters at the right of the grid, add back datasets for all tissues and all assay types. You can select all checkboxes at once by click on the top checkbox, next to “Category”. Also remove non-core assays if it is selected</li>
</ul>
<p><img src="img/portal_selectAllTissues.png" /></p>
<p><img src="img/portal_selectAllAssays.png" /></p>
<p><img src="img/portal_deselect_non_core_assays.png" /></p>
<ul>
<li>Select all ChIP-Seq marks for the cell type “Myeloid cell”, under the “Bone Marrow” category. The first 6 columns should be selected</li>
</ul>
<p><img src="img/portal_blueprint_chipseq.png" /></p>
<ul>
<li><p>At the bottom of the grid, click on the button “Correlate datasets”</p></li>
<li><p>You will see that similar tracks (e.g. those of the same assay, seem to correlate nicely. You can zoom in the view with the mouse scrolling wheel, or with the buttons at the lower right corner of the popup</p></li>
</ul>
<p><img src="img/portal_clusteringPerMark.png" /></p>
<ul>
<li>You can also use the correlation tool to assess whether datasets that are supposed to be similar actually are
<ul>
<li>Close the correlation popup window with the top right “X” button</li>
<li>Reset grid selection with the “Reset” button at the bottom of the grid</li>
<li>Click on the grid cell for cell type “CD4-positive, alpha-beta T cell”, under the “Blood” category, and assay “H3K27ac”</li>
<li>Click on “Correlate datasets”</li>
<li>One dataset seems to be an outlier. This could be, for instance, a problem with the quality of the dataset, or the underlying metadata can indicate that something is different (disease status or some other key element)</li>
</ul></li>
</ul>
<p><img src="img/portal_selectTcell.png" /></p>
<p>You should get something like this:</p>
<p><img src="img/portal_correlationOutlier.png" /></p>
</div>
</div>
<div id="predicting-motifs-with-homer" class="section level3 hasAnchor">
<h3>Predicting Motifs with HOMER<a href="module-5-downstream-analysis-and-online-tools.html#predicting-motifs-with-homer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will now attempt to detect motifs in peak regions for transcription factor binding sites using HOMER</p>
<ul>
<li>Reset to the default IHEC Data Portal view by clicking “Data Grid” in the top bar</li>
</ul>
<p><img src="img/HOMER_selectDataGrid.png" /></p>
<p>Choose Assembly <code>hg19.</code></p>
<p><img src="img/HOMER_selecthg19.png" /></p>
<ul>
<li>In the filters to the right of the grid, activate non-core IHEC assays, and display only Transcription Factor Binding Sites (<code>TFBS</code>) assays</li>
</ul>
<p><img src="img/HOMER_showNonCoreAssays.png" /></p>
<p><img src="img/HOMER_showTFBS.png" /></p>
<ul>
<li>In the grid, select ENCODE datasets for the <code>CTCF</code> assay and the <code>B cell</code> cell type</li>
</ul>
<p><img src="img/HOMER_selectCTCF.png" /></p>
<ul>
<li>Go to the track list at the bottom of the grid and select only the dataset for sample “ENCBS400ARI”</li>
</ul>
<p><img src="img/HOMER_selectPeaksTrack.png" /></p>
<ul>
<li>You can get the URL to the track you want by clicking on the “Download tracks” button at the bottom of the grid Here, we’re interested in <code>https://epigenomesportal.ca/tracks/ENCODE/hg19/84840.ENCODE.ENCBS400ARI.CTCF.peak_calls.bigBed</code>. This file contains peaks that were called out of the TFBS ChIP-Seq experiment</li>
<li>Useful tip: You can get the full set of metadata about ENCODE experiments and samples by consulting the ENCODE portal, and searching for a given sample name. In this case: <code>https://www.encodeproject.org/biosamples/ENCBS400ARI/</code></li>
<li>Open your AWS terminal session, create a directory for our HOMER-related files, and go into it. Then, download the BigBed file</li>
</ul>
<pre><code>mkdir homer
cd homer
wget https://epigenomesportal.ca/tracks/ENCODE/hg19/84840.ENCODE.ENCBS400ARI.CTCF.peak_calls.bigBed</code></pre>
<ul>
<li>UCSC provides a set of file format conversion tools, such as <code>bigBedToBed</code>, which converts a binary bigbed file to its plain text file equivalent. Some of these tools have been pre-installed on your AWS image</li>
<li>Convert the bigBed file into a bed file using the UCSC set of tools</li>
</ul>
<pre><code>bigBedToBed 84840.ENCODE.ENCBS400ARI.CTCF.peak_calls.bigBed 84840.ENCODE.ENCBS400ARI.CTCF.peak_calls.bed</code></pre>
<ul>
<li>Prepare an output directory for HOMER, and a genome preparsed motifs directory</li>
</ul>
<pre><code>mkdir output
mkdir preparsed</code></pre>
<ul>
<li>Run the HOMER software to identify motifs in the peak regions
<ul>
<li>-p 4 indicates to use 4 cores.</li>
<li>-S 15 tells Homer to find 15 motifs, instead of the default 25, for execution speed purposes.</li>
<li>You can get the full list of parameters here: <a href="http://homer.ucsd.edu/homer/ngs/peakMotifs.html" class="uri">http://homer.ucsd.edu/homer/ngs/peakMotifs.html</a></li>
</ul></li>
</ul>
<pre><code>findMotifsGenome.pl 84840.ENCODE.ENCBS400ARI.CTCF.peak_calls.bed hg19 output -preparsedDir preparsed -p 4 -S 15</code></pre>
<ul>
<li>HOMER takes a while to execute for a whole genome track like this. Expect this job to take about 30 minutes of runtime, with your current setup. In the meantime, we will explore the GO terms enrichment tool GREAT</li>
</ul>
</div>
<div id="looking-for-go-terms-enrichment-with-great" class="section level3 hasAnchor">
<h3>Looking for GO Terms Enrichment with GREAT<a href="module-5-downstream-analysis-and-online-tools.html#looking-for-go-terms-enrichment-with-great" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we will try to identify GO terms connected to ChIP-Seq peaks calls using GREAT. We need <code>bed</code> files to use the GREAT portal. We will do the conversion from a <code>bigBed</code> file to a <code>bed</code> file on our AWS session</p>
<ul>
<li>In the IHEC Data Portal, go back to the default grid page (by clicking on Data Grid in the top bar). For assembly <code>Human (hg38)</code>, filter the tissues list to keep only “Bone Marrow” tissues</li>
</ul>
<p><img src="img/GREAT_select_bone_marrow.png" /></p>
<ul>
<li>Select the datasets for cell type “Myeloid cell” and assay H3K27ac</li>
</ul>
<p><img src="img/GREAT_bone_marrow_h3k27ac.png" /></p>
<ul>
<li>For this exercise, we will download only one of the bigbeds for available datasets. Pick up the dataset below, for sample <code>ERS1027405</code>:</li>
</ul>
<p><img src="img/GREAT_selectSomeBoneMarrowDatasets.png" /></p>
<ul>
<li><p>Click “Download tracks” at the bottom of the grid</p></li>
<li><p>On the download page, click on <code>View Full URL List</code>. This will give you a text list with all tracks of interest Copy the link to this page in your clipboard, using the address provided in your browser’s URL bar</p></li>
</ul>
<p><img src="img/GREAT_batch_download.png" /></p>
<ul>
<li><p>Open another terminal session to get into AWS</p></li>
<li><p>Go to your module5 directory and create a place to put the material we will download</p></li>
</ul>
<pre><code>cd ~/workspace/module5
mkdir great
cd great</code></pre>
<ul>
<li>For you own analyses, you can download a bunch of tracks at the same time by using wget on a list of URLs
<ul>
<li>Use the <strong>wget</strong> command to download the text file that contains the list of tracks</li>
</ul></li>
</ul>
<pre><code>wget -O trackList.txt &#39;https://epigenomesportal.ca/api/datahub/download?session=18731&amp;format=text&#39;</code></pre>
<ul>
<li>Now download the tracks that are contained in this list</li>
</ul>
<pre><code>wget -i trackList.txt</code></pre>
<ul>
<li>Convert the bigbed using the UCSC set of tools</li>
</ul>
<pre><code>bigBedToBed 58394.Blueprint.ERS1027405.H3K27ac.peak_calls.bigBed 58394.Blueprint.ERS1027405.H3K27ac.peak_calls.bed</code></pre>
<div class="callout-blue">
<span class="callout-icon"><i class="fas fa-circle-info" aria-hidden="true"></i></span>
<div class="callout-content">
<div class="callout-title-static">
<p>Note</p>
</div>
<p>If you’re under Linux / Mac, you can also install the UCSC tools locally, as they are a useful set of tools to manipulate tracks data, without requiring so much processing power.</p>
</div>
</div>
<ul>
<li>GREAT has a limit on the number of regions to be tested in one execution. Therefore, we need to subsample our file. We can create a BED file subsample this way:
<ul>
<li>Sort BED file in random order with <code>sort -R</code></li>
<li>Take the 20000 first lines in the file with head <code>-n20000</code></li>
</ul></li>
</ul>
<pre><code>sort -R 58394.Blueprint.ERS1027405.H3K27ac.peak_calls.bed &gt; 58394.Blueprint.ERS1027405.H3K27ac.peak_calls.random.bed
head -n 20000 58394.Blueprint.ERS1027405.H3K27ac.peak_calls.random.bed &gt; 58394.Blueprint.ERS1027405.H3K27ac.peak_calls.random_short.bed</code></pre>
<ul>
<li>From your local computer, download the BED file <code>58394.Blueprint.ERS1027405.H3K27ac.peak_calls.random_short.bed</code> locally using your browser</li>
</ul>
<pre><code>http://&lt;your VM ip address&gt;/module5/great/58394.Blueprint.ERS1027405.H3K27ac.peak_calls.random_short.bed</code></pre>
<ul>
<li><p>Load the GREAT website: <a href="http://bejerano.stanford.edu/great/public/html/" class="uri">http://bejerano.stanford.edu/great/public/html/</a></p></li>
<li><p>Provide the following input to the GREAT interface:</p>
<ul>
<li>Assembly: Human: GRCh38</li>
<li>Test regions: The randomized short version of the BED files you just downloaded (58394.Blueprint.ERS1027405.H3K27ac.peak_calls.random_short.bed)</li>
<li>Leave the “Background regions” to its default value, “Whole Genome”</li>
</ul></li>
<li><p>Submit the form</p></li>
<li><p>In the results, for instance, you should obtain something like this for biological processes:</p></li>
</ul>
<p><img src="img/GREAT_go_biological_process.png" /></p>
<p>Bonus question: Why is your result slightly different from the screenshot?</p>
</div>
<div id="going-back-to-homer-results" class="section level3 hasAnchor">
<h3>Going back to HOMER Results<a href="module-5-downstream-analysis-and-online-tools.html#going-back-to-homer-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Is the job done? If it is completed, you can bring back HOMER results to your laptop for visualization. First we’ll compress the results to a zip file</li>
</ul>
<pre><code>cd ~/workspace/module5/homer/
zip -r homer.zip output</code></pre>
<ul>
<li>Next, with your web browser, download the zipped result set</li>
</ul>
<pre><code>http://&lt;your VM ip address&gt;/module5/homer/homer.zip</code></pre>
<ul>
<li>Unzip the file, and open the de novo and known motifs HTML files in a browser for visualization. Do the identified motifs fit what we would expect?</li>
</ul>
<p><img src="img/HOMER_results.png" /></p>
<div id="all-done" class="section level4 hasAnchor">
<h4>All done!<a href="module-5-downstream-analysis-and-online-tools.html#all-done" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you have time remaining, you can explore further the tools that we covered in this lab, using other types of datasets. For example, does running a GREAT query on another cell type yield the type of annotations that you’d expect?</p>
<p><strong>Interested in exploring Galaxy?</strong> You can start tackling a Galaxy introduction extra lab, available <a href="https://bioinformaticsdotca.github.io/EPI_2023_module5_galaxy">here</a>. It uses the usegalaxy.org server, so you can also follow it at your own pace after the workshop.</p>
<div class="callout-green">
<span class="callout-icon"><i class="fas fa-circle-check" aria-hidden="true"></i></span>
<div class="callout-content">
<div class="callout-title-static">
<p>Lab Completed!</p>
</div>
<p>Congratulations! You have completed Lab 5!</p>
</div>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="module-4-whole-genome-bisulfite-sequencing-and-analysis.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/bioinformaticsdotca/EPI_2023/blob/main/050-module-5.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
