"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_code-nav_code-nav_ts-ui_packages_filter-sort_filter-sort_ts-ui_packages_fuzzy-fil-1f9dbe"],{32687:(e,t,i)=>{i.d(t,{KY:()=>s.KY,Kv:()=>s.Kv,Op:()=>s.Op,tz:()=>r.tz,v0:()=>n.v0});var n=i(15324),s=i(82191),r=i(17844);i(65727)},82191:(e,t,i)=>{i.d(t,{KY:()=>u,Kv:()=>d,Op:()=>CodeNavigationInfo});var n=i(50467),s=i(96235),r=i(60039),l=i(15324),a=i(17844),o=i(65727);let CodeNavigationInfo=class CodeNavigationInfo{initCodeSections(){let e=new Map,t=new Map;for(let i=0;i<this.symbols.length;i++)if(this.symbols[i].lineNumber<this.symbols[i].extent.end.line-2){let n={startLine:this.symbols[i].lineNumber,endLine:this.symbols[i].extent.end.line,index:i,collapsed:!1,level:this.symbols[i].depth};if(e.has(n.startLine)){let t=e.get(n.startLine);t.push(n),e.set(n.startLine,t)}else e.set(n.startLine,[n]);if(e.has(n.endLine)){let t=e.get(n.endLine);t.push(n),e.set(n.endLine,t)}else e.set(n.endLine,[n]);for(let e=n.startLine+1;e<n.endLine;e++)if(t.has(e)){let i=t.get(e);i.push(n),t.set(e,i)}else t.set(e,[n])}this.lineToSectionMap=t,this.codeSections=e}initSymbols(e){return e.map(e=>{let t=this.blobLines[e.ident_utf16.start.line_number]||"",i=(0,o.N_)(e,t,{stylingDirectives:this.stylingDirectives,repo:this.repo,refInfo:this.refInfo,path:this.path});return this.lineIndexedSymbols[i.lineNumber]=i,i})}getBlobLine(e){return this.blobLines[e]||""}getSymbolOnLine(e){return this.lineIndexedSymbols[e]}initSymbolTree(){if(this.symbols){let e=[],t=this.symbols.filter(e=>"field"!==e.kind.fullName).map(t=>{let i=0;for(let r=e.length-1;r>=0;r--){var n,s;if(n=t,s=e[r],n.extent.start.line===s.extent.end.line?n.extent.start.column>s.extent.end.column:n.extent.start.line>s.extent.end.line)e.pop();else{i=e.length;break}}return e.push(t),t.setSymbolDepth(i),{symbol:t,depth:i}});this.symbolTree=[];for(let e=0;e<t.length;e++){let i=t[e];if(e+1<t.length&&t[e+1].depth>i.depth){let n=function e(t,i){let n=[],s=t[i];for(let r=i+1;r<t.length;r++){let i=t[r];if(i.depth>s.depth){let s=e(t,r);r+=c(s),n.push({symbol:i.symbol,children:s,isParent:s.length>0})}else break}return n}(t,e);e+=c(n),this.symbolTree.push({symbol:i.symbol,isParent:!0,children:n});continue}this.symbolTree.push({symbol:i.symbol,isParent:!1,children:[]})}}}createReferences(e){return e.map(e=>{let t=new l.BW({ident:e,repo:this.repo,refInfo:this.refInfo,path:this.path,isPlain:this.isPlain,source:l.u.BLOB_CONTENT});return t.setSnippet(void 0,this.stylingDirectives?.[e.start.line],this.blobLines[e.start.line],void 0),t})}getReferencesToSymbol(e){let t=d(this.blobLines,(0,a.ah)(e));return this.createReferences(t)}getReferencesToSearch(e){let t=d(this.blobLines,(0,a.tz)(e));return this.createReferences(t)}getDefinitionsAndReferences(e,t,i){this.setLoading(!0);let n=(async()=>{let n=this.getSymbolOnLine(t+1);if(n&&n.name===e)return{definitions:[n],backend:"search"};let[s,r]=await this.getAlephDefinitions(e,t,i,this.loggedIn);if("search"===r){let t=this.getLocalDefinitions(e);t.length>0&&(s=t);let i=s.find(e=>e.path===this.path&&e.repo===this.repo);i&&(s=[i]),r="search"}else{let t=this.getLocalDefinitions(e,!0);for(let i of s)""===i.kind.fullName&&i.name===e&&(i.kind=t[0]?t[0].kind:new l.v0({kind:""}))}return{definitions:s,backend:r}})(),s=(async()=>{let{definitions:t}=await n,i=t.map(e=>e.lineNumber);return{references:this.getReferencesToSymbol(e).filter(e=>!i.includes(e.lineNumber)),backend:"search"}})(),r=(async()=>{let s="SYMBOL_KIND_UNKNOWN",r=this.getSymbolOnLine(t+1);if(r)s=r.kind.enumStringVal;else{let{definitions:e}=await n;s=e[0]?.kind?.enumStringVal||s}return this.getAlephReferences(e,t,i,this.loggedIn,s)})();return{definitions:n,localReferences:s,crossReferences:(async()=>{let[e,t]=await r;return{references:e,backend:t}})(),setLoading:this.setLoading}}getLocalDefinitions(e,t=!1){let i=9,n=[];for(let s of this.symbols)s.name===e&&(s.kind.rank<i||t)&&(i=s.kind.rank,n=[s]);return n}async getAlephDefinitions(e,t,i,n){let l,a,c="search";if(""===e&&-1===t&&-1===i||!n)return[[],c];let d=(0,s.lkl)({repo:this.repo,type:"definition",q:e,language:this.language,row:t,column:i,ref:this.refInfo.name,path:this.path,codeNavContext:"BLOB_VIEW",symbolKind:null});try{l=await (0,r.lS)(d)}catch{return[[],c]}if(!l.ok)return[[],c];try{a=await l.json()}catch{return[[],c]}return c=h(a.backend)??"search",[a.payload.flatMap(e=>e).map(t=>(0,o.zs)(t,{stylingDirectives:this.stylingDirectives,repo:this.repo,refInfo:this.refInfo,path:this.path,symbol:e,backend:c})),c]}async getAlephReferences(e,t,i,n,l){let a,c="search";if(""===e&&-1===t&&-1===i||!n)return[[],c];let d=(0,s.lkl)({repo:this.repo,type:"references",q:e,language:this.language,row:t,column:i,ref:this.refInfo.name,path:this.path,codeNavContext:"BLOB_VIEW",symbolKind:l}),u=await (0,r.lS)(d);if(!u.ok)return[[],c];try{a=await u.json()}catch{return[[],c]}c=h(a.backend)??"search";let f=new Set;return[a.payload.flatMap(e=>e).reduce((e,t)=>{var i;if(t.path===this.path)return e;let n=(0,o.QV)(t,{stylingDirectives:this.stylingDirectives,repo:this.repo,refInfo:this.refInfo,path:this.path,backend:c});return i=n.lineNumber,f.has(i)||(f.add(i),0)||e.push(n),e},[]).sort((e,t)=>e.lineNumber-t.lineNumber),c]}constructor(e,t,i,s,r,l,a,o,h,c){(0,n._)(this,"repo",void 0),(0,n._)(this,"refInfo",void 0),(0,n._)(this,"language",void 0),(0,n._)(this,"path",void 0),(0,n._)(this,"loggedIn",void 0),(0,n._)(this,"blobLines",void 0),(0,n._)(this,"symbols",void 0),(0,n._)(this,"lineIndexedSymbols",{}),(0,n._)(this,"isPlain",void 0),(0,n._)(this,"stylingDirectives",void 0),(0,n._)(this,"setLoading",void 0),this.setLoading=c,this.setLoading(!0),this.repo=e,this.refInfo=t,this.path=i,this.loggedIn=s,this.language=o,this.blobLines=r,this.stylingDirectives=a,this.isPlain=h,this.symbols=this.initSymbols(l),this.initSymbolTree(),this.initCodeSections(),this.setLoading(!1)}};function h(e){switch(e){case"ALEPH_PRECISE":case"ALEPH_PRECISE_PREVIEW":case"ALEPH_PRECISE_DEVELOPMENT":return"precise";case"BLACKBIRD":return"search";default:return null}}function c(e){let t=e.length;for(let i=0;i<e.length;i++){let n=e[i];n.isParent&&(t+=c(n.children))}return t}function d(e,t){let i=[],n=(0,a.lA)(t,e),s=n.next();for(;!s.done&&i.length<200;){let{column:e,columnEnd:t,line:r}=s.value;i.push({start:{line:r,column:e},end:{line:r,column:t}}),s=n.next()}return i}function u(e,t,i){if(0===e.length)return[];let n=e.length>=200,s={},r=e.reduce((e,n)=>{if(s[n.ident.start.line])return e;s[n.ident.start.line]=!0;let r=(0,a.lA)(i,[t[n.ident.start.line]]),l=r.next();for(;!l.done&&e.length<200;){let{column:t,columnEnd:i}=l.value;e.push({start:{line:n.ident.start.line,column:t},end:{line:n.ident.start.line,column:i}}),l=r.next()}return e},[]);if(r.length<200&&n){let n=e[e.length-1].ident.start.line,s=(0,a.lA)(i,t,n),l=s.next();for(;!l.done&&r.length<200;){let{line:e,column:t,columnEnd:i}=l.value;r.push({start:{line:e,column:t},end:{line:e,column:i}}),l=s.next()}}return r}},15324:(e,t,i)=>{i.d(t,{AP:()=>CodeSymbol,BW:()=>CodeReference,u:()=>r,v0:()=>SymbolKind});var n=i(50467),s=i(96235);let r={BLACKBIRD_SEARCH:"blackbird-search",BLACKBIRD_ANALYSIS:"blackbird-analysis",ALEPH_PRECISE:"aleph-precise",BLOB_CONTENT:"blob-content-search"};let SymbolKind=class SymbolKind{constructor({kind:e}){(0,n._)(this,"enumStringVal",void 0),(0,n._)(this,"fullName",void 0),(0,n._)(this,"shortName",void 0),(0,n._)(this,"plColor",void 0),(0,n._)(this,"rank",void 0);let[t,i]=function(e){if("string"==typeof e){let t=e.toString().replace("SYMBOL_KIND_","").replace(/_DEF$/,"").replace(/_REF$/,"").toLowerCase();if(e.startsWith("SYMBOL_KIND_"))return[t,e.toString()];if(""!==e&&"unknown"!==e){let t=`SYMBOL_KIND_${e.toUpperCase()}`;return"call"===e?t+="_REF":t+="_DEF",[e,t]}}return["unknown","SYMBOL_KIND_UNKNOWN"]}(e);this.enumStringVal=i,this.fullName=t,this.shortName=function(e){switch(e){case"function":case"method":return"func";case"interface":return"intf";case"implementation":return"impl";case"constant":return"const";case"module":return"mod";case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"class":case"call":case"enum":case"field":case"macro":case"struct":case"trait":case"type":case"union":return e;default:return e.substring(0,1)}}(t),this.plColor=function(e){switch(e){case"function":case"method":default:return"prettylights.syntax.entity";case"class":case"enum":case"struct":case"union":return"prettylights.syntax.constant";case"interface":case"trait":return"prettylights.syntax.keyword";case"constant":case"field":case"enum member":return"prettylights.syntax.variable";case"implementation":return"prettylights.syntax.string"}}(t),this.rank=({class:1,struct:1,enum:1,type:2,interface:3,trait:3,module:4,implementation:5,function:6,method:7,call:8,field:9})[t]||9}};let CodeSymbol=class CodeSymbol{setSymbolDepth(e){this.depth=e}setFileInfo(e,t,i){this.repo=e,this.refInfo=t,this.path=i}get lineNumber(){return this.ident.start.line+1}setSnippet(e,t,i,n){this.highlightedText=e,this.stylingDirectives=t,this.bodyText=i,this.leadingWhitespace=n}href(){if(!this.repo||!this.refInfo||!this.path)return`/${window.location.pathname}#L${this.lineNumber}`;let e=this.source===r.BLACKBIRD_SEARCH?this.repo.defaultBranch:this.refInfo.name||this.refInfo.currentOid;return(0,s.nD_)({owner:this.repo.ownerLogin,repo:this.repo.name,commitish:e,filePath:this.path,lineNumber:this.lineNumber})}pathKey(){return`${this.repo.ownerLogin}/${this.repo.name}/${this.refInfo.currentOid}/${this.path}`}constructor({ident:e,extent:t,kind:i,name:s,fullyQualifiedName:r,source:l}){(0,n._)(this,"ident",void 0),(0,n._)(this,"extent",void 0),(0,n._)(this,"kind",void 0),(0,n._)(this,"name",void 0),(0,n._)(this,"fullyQualifiedName",void 0),(0,n._)(this,"highlightedText",void 0),(0,n._)(this,"stylingDirectives",void 0),(0,n._)(this,"leadingWhitespace",void 0),(0,n._)(this,"source",void 0),this.ident=e,this.extent=t,this.kind=new SymbolKind({kind:i}),this.name=s,this.fullyQualifiedName=r,this.source=l}};let CodeReference=class CodeReference{get lineNumber(){return this.ident.start.line+1}href(e){if(!this.repo||!this.refInfo||!this.path)return`/${window.location.pathname}#L${this.lineNumber}`;let t=this.source===r.BLACKBIRD_SEARCH?this.repo.defaultBranch:this.refInfo.name||this.refInfo.currentOid,i={owner:this.repo.ownerLogin,repo:this.repo.name,commitish:t,filePath:this.path,lineNumber:this.lineNumber,plain:this.isPlain?1:void 0};return e?(0,s.buO)(i):(0,s.nD_)(i)}setSnippet(e,t,i,n){this.highlightedText=e,this.stylingDirectives=t,this.bodyText=i,this.leadingWhitespace=n}pathKey(){return`${this.repo.ownerLogin}/${this.repo.name}/${this.refInfo.currentOid}/${this.path}`}constructor({ident:e,repo:t,refInfo:i,path:s,isPlain:r,source:l}){(0,n._)(this,"ident",void 0),(0,n._)(this,"repo",void 0),(0,n._)(this,"refInfo",void 0),(0,n._)(this,"path",void 0),(0,n._)(this,"isPlain",void 0),(0,n._)(this,"highlightedText",void 0),(0,n._)(this,"stylingDirectives",void 0),(0,n._)(this,"source",void 0),(0,n._)(this,"leadingWhitespace",void 0),this.ident=e,this.repo=t,this.refInfo=i,this.path=s,this.isPlain=r??!1,this.source=l}}},17844:(e,t,i)=>{i.d(t,{ah:()=>s,lA:()=>l,tz:()=>r});let n={Text:"Text",Symbol:"Symbol"};function s(e){let t=`(\\W|^)${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\W|$)`;return{kind:n.Symbol,regexp:RegExp(t,"g")}}function r(e){let t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{kind:n.Text,regexp:RegExp(t,"gi")}}function*l(e,t,i=0){for(let s=i;s<t.length;s++){let i,r=t[s];for(;null!==(i=e.regexp.exec(r));){let t=i[0],l=i.index;e.kind===n.Symbol&&(t.length>0&&/\W/.test(t[0])&&(t=t.substring(1),l+=i[0].length-t.length),t.length>0&&/\W/.test(t[t.length-1])&&(t=t.substring(0,t.length-1))),yield{line:s,column:l,columnEnd:l+t.length,text:r}}}}},65727:(e,t,i)=>{i.d(t,{N_:()=>s,QV:()=>l,zs:()=>r});var n=i(15324);function s(e,t,{stylingDirectives:i,repo:s,refInfo:r,path:l}){let{extent_utf16:a,ident_utf16:o}=e,h=new n.AP({kind:e.kind,fullyQualifiedName:e.fully_qualified_name,name:e.name,extent:{start:{line:a.start.line_number,column:a.start.utf16_col},end:{line:a.end.line_number,column:a.end.utf16_col}},ident:{start:{line:o.start.line_number,column:o.start.utf16_col},end:{line:o.end.line_number,column:o.end.utf16_col}},source:n.u.BLACKBIRD_ANALYSIS});return h.setSnippet(void 0,i?.[o.start.line_number],t,void 0),h.setFileInfo(s,r,l),h}function r(e,{symbol:t,refInfo:i,repo:s,path:r,backend:l}){let a=e.ident?.start?.character,o=e.ident?.end?.character??e.ident?.start?.character,h={start:{line:e.ident.start.line,column:a?a-e.leadingWhitespace:0},end:{line:e.ident?.end?.line??e.ident.start.line,column:o?o-e.leadingWhitespace:0}},c=e.extent?.start?.character,d=e.extent?.end?.character??e.extent?.start?.character,u={start:{line:e.extent.start.line,column:c||0},end:{line:e.extent.end?.line??e.extent.start.line,column:d||0}},f=new n.AP({ident:h,extent:u,kind:e.symbolKind,name:t,fullyQualifiedName:t,source:"search"===l?n.u.BLACKBIRD_SEARCH:n.u.ALEPH_PRECISE});if(e.local)f.setFileInfo(s,i,r);else if(e.commitOid&&e.path){let t=i;e.commitOid!==i.currentOid&&(t={name:"",listCacheKey:e.commitOid,currentOid:e.commitOid,canEdit:!1}),f.setFileInfo(e.repo??s,t,e.path)}let p=Array(e.leadingWhitespace).fill(" ").join("")+(e.firstLine||"");return f.setSnippet(e.highlightedText,void 0,p,e.leadingWhitespace),f}function l(e,{refInfo:t,path:i,repo:s,backend:r}){let l=t,a=i;!e.local&&e.commitOid&&e.path&&(l=t,a=e.path,e.commitOid!==t.currentOid&&(l={name:"",listCacheKey:e.commitOid,currentOid:e.commitOid,canEdit:!1}));let o=e.ident.start.character,h=e.ident.end?.character,c=new n.BW({repo:s,refInfo:l,path:a,ident:{start:{line:e.ident.start.line,column:o?o-e.leadingWhitespace:0},end:{line:e.ident.end?.line||e.ident.start.line,column:h?h-e.leadingWhitespace:0}},source:"search"===r?n.u.BLACKBIRD_SEARCH:n.u.ALEPH_PRECISE}),d=Array(e.leadingWhitespace).fill(" ").join("")+(e.firstLine||"");return c.setSnippet(e.highlightedText,void 0,d,e.leadingWhitespace),c}},13617:(e,t,i)=>{i.d(t,{d:()=>n});function n(e,t,i){return[...function*(e,t){for(let i of e){let e=t(i);null!=e&&(yield e)}}(e,e=>{let i=t(e);return null!=i?[e,i]:null})].sort((e,t)=>i(e[1],t[1])).map(([e])=>e)}},30695:(e,t,i)=>{function n(e,t,i=.1){let s=l(e,t,i);return s&&-1===t.indexOf("/")&&(s+=l(e.substring(e.lastIndexOf("/")+1),t,i)),s}function s(e,t,i){if(t){let n=e.innerHTML.trim().match(i||function(e){let t=e.toLowerCase().split(""),i="",n=!0;for(let e of t){let t=e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&");n?(i+=`(.*)(${t})`,n=!1):i+=`([^${t}]*?)(${t})`}return RegExp(`${i}(.*?)$`,"i")}(t));if(!n)return;let s=!1,r=[];for(let e=1;e<n.length;++e){let t=n[e];t&&(e%2==0?s||(r.push("<mark>"),s=!0):s&&(r.push("</mark>"),s=!1),r.push(t))}e.innerHTML=r.join("")}else{let t=e.innerHTML.trim(),i=t.replace(/<\/?mark>/g,"");t!==i&&(e.innerHTML=i)}}i.d(t,{He:()=>s,UD:()=>a,dt:()=>n});let r=new Set([" ","-","_"]);function l(e,t,i=.1){let n=e;if(n===t)return 1;let s=n.length,a=0,o=0,h=!0;for(let e of t){let t=n.indexOf(e.toLowerCase()),l=n.indexOf(e.toUpperCase()),c=Math.min(t,l),d=c>-1?c:Math.max(t,l);if(-1===d)return 0;a+=.1,n[d]===e&&(a+=.1),0===d&&(a+=.9-i,h&&(o=1)),r.has(n.charAt(d-1))&&(a+=.9-i),n=n.substring(d+1,s),h=!1}let c=t.length,d=a/c,u=(c/s*d+d)/2;return o&&u+i<1&&(u+=i),u}function a(e,t){return e.score>t.score?-1:e.score<t.score?1:e.text<t.text?-1:1*!!(e.text>t.text)}}}]);
//# sourceMappingURL=ui_packages_code-nav_code-nav_ts-ui_packages_filter-sort_filter-sort_ts-ui_packages_fuzzy-fil-1f9dbe-c1a289e9dbd3.js.map